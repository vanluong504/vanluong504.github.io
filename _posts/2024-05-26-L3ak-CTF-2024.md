---
title: L3ak CTF 2024 - Writeup
date: 2024-05-26 00:00:00
categories: [CTF]
tags: [CTF, L3ak CTF 2024]
image: /assets/image/CTF/L3akCTF2024/logo.png
math: true
---

### Matrix Magic

#### Attachments

```python

from sage.all import *
from Crypto.Util.number import getPrime, isPrime
import os

def get_random(n):
    return int.from_bytes(os.urandom(n//8  + 1), "big")

def get_safe_prime(nbit):
    result = 2 * getPrime(nbit // 2) * getPrime(nbit // 2) + 1
    while not isPrime(int(result)):
        result = 2 * getPrime(nbit // 2) * getPrime(nbit // 2) + 1
    return result


FLAG = int.from_bytes(open("flag.txt", "rb").read().strip(), "big")

nbit = 1024

p = get_safe_prime(nbit // 2)
q = get_safe_prime(nbit // 2)
n = p*q

Mat = matrix(Zmod(n), [
    [2, 1] + [get_random(nbit) for _ in range(4)],
    [0, 2] + [get_random(nbit) for _ in range(4)],
    [0, 0] + [4, 1] + [get_random(nbit) for _ in range(2)],
    [0, 0] + [0, 4] + [get_random(nbit) for _ in range(2)],
    [0, 0] + [0, 0] + [8, 1],
    [0, 0] + [0, 0] + [0, 8]
])

C = Mat^FLAG
C = list(C)

with open("output.txt", "w") as f:
    f.write(f"{C = }")
```

```text
# output
C = [(34285747519707996626385667339662460790207453899564234933279840884637317470277963204844978855648863282661822817842406467276103235437115285776600339324582650206354227684286926765912841373720037206104315460984467834472878792871363724319500026730744559032592830317957861116684230815080884748210510265257121727411, 82389813574193236731268728055226346949935905889688170425892513962291738546070054175286986817742962125712704451033935523159914920684418980229184675189392660990212113237529057511102468180315624316711603102279872782413287481544411903032504611191117588506754985276936284421146109462510942343677179125102460355334, 127247078267314356402767966557448505733207679608121587776826570427528349536126399258128998506925096202352385266899982179247602157054605592001529350471426605916092686761690699179270970709575073044160148478140835495982904453410049961250136921488023338211130908836050232268149658252094451825981649386429967157023, 110997696050305177374684801376195205614043414698289134283464488914579055650336577562089998807469786126102628845652757901772021003891120075086100794690060492018372114798499796476503564426511552576093110306562634265833200794380828146503816203682087385703698944330589010185628240036153869595329794474678963954269, 95429943964904023259514531987953637596024020044100694025548029082876352647190904910373013883591092911247251504859346180249828148105405110896981416324094823746473360350150849817138654025822760100976625537661710179191573475427725481576122332324895773326199055069720422096583714906980119788052757109463536989130, 76925650644921944564121660415039326382672571942134701742579804900375156897677412516140878223663671839157682242947665571676520752706843330108967323669457404588586535061237444710279897627741144122937187393054928934936687732687921193790751566393662886825169077208127284176632544803227991370949818150005932210304), (0, 34285747519707996626385667339662460790207453899564234933279840884637317470277963204844978855648863282661822817842406467276103235437115285776600339324582650206354227684286926765912841373720037206104315460984467834472878792871363724319500026730744559032592830317957861116684230815080884748210510265257121727411, 85967636444726554256032386847538080607273641997139556709873191645024773479482183751659433639594934875197169824518560503372716992088412826701271790577397701838066670897181757432783438839115526851698428389903365201752735197054876789440370911041505435306549154757322168278884403206082946661059841799276902279607, 110321848943899292929831522195898953167052692821484311182642200713072229078674653831094653900345561159369211814825383018259327689455180388330932020089176571654576145870074563603252413779245365342554600824303390696086590372070050354595330074227342114164575397697848706436203854215556384244963529017935602600689, 55321436108075224950728586469455754360500596962017688262306497027259209074949803121055336152763619653715618911652213266949708309957674991371935559144633368828172207173145372615220450607178667764319048810554905786212377479905241378131059006116348325599909367174854478256625377537634718283487921887388679931300, 121048214328487578063535470984430739166205977393814304445813791572773220134359940700786671669567539273399625221907347167959074671295760177948556479010579225978917918535032412717072730223986401267581116138177971941402742413385270319230751393845616816965070450211819298226894334399356881715479006792296977303116), (0, 0, 80891788386112939497749276978496951092908047537517752191112348346041605282820278415204830919700840360371114407873821260986140627885494462923855784343766007471406691139724032186081486065167152331309928933439563087594932165713814698240940689654799590764311096627705559355661741126880749623083953480524440103996, 98127807327139994371479310755482264253499077621954160265776803909962087269443207623777017430975688540885576031084499718360878131623357206459366594111595569751254398053416214104147757969318816248746123610412479211529236153906708864168414330919431944363564172025204269508207805032491500543298879609362168155698, 65511482182385099252523608525317643713139065614405324455763784441479732896196144143630212812577305057210145612770975280343168022555945650814573970996890826522557999047275529322348420693034478105886809355222570889445527587635177667364042090723912339748512431185136779345494523747668733698804934976215893958288, 47395420931311533463576620820998773093140094423967370338777509171164699213419123512474441784558146041667540557107610725716163070022770572094504815720978368593469076026134774205916872923158523446883115622548066715665889163816586554653727221255672945695748970848307935789400330008330191289067490505817853508862), (0, 0, 0, 80891788386112939497749276978496951092908047537517752191112348346041605282820278415204830919700840360371114407873821260986140627885494462923855784343766007471406691139724032186081486065167152331309928933439563087594932165713814698240940689654799590764311096627705559355661741126880749623083953480524440103996, 19698820472058378412126192842030797220400882933373012220982539297272840493833295012123104281630408975161684583174403520414441877705582176563034772573895923595952612217426667572338807473485060098014543992573292667351072747962727283791740574278403611513201362656878372277715791010274896917611983518661952140153, 123510953871821884312855093053364645536177520009689630246292371010124299893864894909800725518340823661094473516585146142340021906280407678497822070318952778328284650261834023459467329786786889648844029738405121401290299843929018994002831246816483309594538299064894303565350991068375984784398159294612728278815), (0, 0, 0, 0, 36580210170460317737762146444885635769591964296289890711389087000847139534806165797517572963756420701630101713343229692997790887039708011239887899158602488099058023454307392387825436996066794401349180417178870019892425641929320878895403740655587101563655595067050855919740156100994268635382369423383067032821, 39071393947194921035771816301731926515001496696996162605545586710593160202215733075781810261530483080161843001707288615255381706789857593381598670763208249387924275996361728526530257131514765795139507343167639937751870811497537961210868263876827751668386006289349446841212411861730197725192485058916383785937), (0, 0, 0, 0, 0, 36580210170460317737762146444885635769591964296289890711389087000847139534806165797517572963756420701630101713343229692997790887039708011239887899158602488099058023454307392387825436996066794401349180417178870019892425641929320878895403740655587101563655595067050855919740156100994268635382369423383067032821)]
```

#### Implement

Bài mày ta chỉ cần chú ý đến phần này là giải được

```python
Mat = matrix(Zmod(n), [
    [2, 1] + [get_random(nbit) for _ in range(4)],
    [0, 2] + [get_random(nbit) for _ in range(4)],
    [0, 0] + [4, 1] + [get_random(nbit) for _ in range(2)],
    [0, 0] + [0, 4] + [get_random(nbit) for _ in range(2)],
    [0, 0] + [0, 0] + [8, 1],
    [0, 0] + [0, 0] + [0, 8]
])

C = Mat^FLAG
C = list(C)
```

Python Implementations

```python
from Crypto.Util.number import *

C = [(34285747519707996626385667339662460790207453899564234933279840884637317470277963204844978855648863282661822817842406467276103235437115285776600339324582650206354227684286926765912841373720037206104315460984467834472878792871363724319500026730744559032592830317957861116684230815080884748210510265257121727411, 82389813574193236731268728055226346949935905889688170425892513962291738546070054175286986817742962125712704451033935523159914920684418980229184675189392660990212113237529057511102468180315624316711603102279872782413287481544411903032504611191117588506754985276936284421146109462510942343677179125102460355334, 127247078267314356402767966557448505733207679608121587776826570427528349536126399258128998506925096202352385266899982179247602157054605592001529350471426605916092686761690699179270970709575073044160148478140835495982904453410049961250136921488023338211130908836050232268149658252094451825981649386429967157023, 110997696050305177374684801376195205614043414698289134283464488914579055650336577562089998807469786126102628845652757901772021003891120075086100794690060492018372114798499796476503564426511552576093110306562634265833200794380828146503816203682087385703698944330589010185628240036153869595329794474678963954269, 95429943964904023259514531987953637596024020044100694025548029082876352647190904910373013883591092911247251504859346180249828148105405110896981416324094823746473360350150849817138654025822760100976625537661710179191573475427725481576122332324895773326199055069720422096583714906980119788052757109463536989130, 76925650644921944564121660415039326382672571942134701742579804900375156897677412516140878223663671839157682242947665571676520752706843330108967323669457404588586535061237444710279897627741144122937187393054928934936687732687921193790751566393662886825169077208127284176632544803227991370949818150005932210304), (0, 34285747519707996626385667339662460790207453899564234933279840884637317470277963204844978855648863282661822817842406467276103235437115285776600339324582650206354227684286926765912841373720037206104315460984467834472878792871363724319500026730744559032592830317957861116684230815080884748210510265257121727411, 85967636444726554256032386847538080607273641997139556709873191645024773479482183751659433639594934875197169824518560503372716992088412826701271790577397701838066670897181757432783438839115526851698428389903365201752735197054876789440370911041505435306549154757322168278884403206082946661059841799276902279607, 110321848943899292929831522195898953167052692821484311182642200713072229078674653831094653900345561159369211814825383018259327689455180388330932020089176571654576145870074563603252413779245365342554600824303390696086590372070050354595330074227342114164575397697848706436203854215556384244963529017935602600689, 55321436108075224950728586469455754360500596962017688262306497027259209074949803121055336152763619653715618911652213266949708309957674991371935559144633368828172207173145372615220450607178667764319048810554905786212377479905241378131059006116348325599909367174854478256625377537634718283487921887388679931300, 121048214328487578063535470984430739166205977393814304445813791572773220134359940700786671669567539273399625221907347167959074671295760177948556479010579225978917918535032412717072730223986401267581116138177971941402742413385270319230751393845616816965070450211819298226894334399356881715479006792296977303116), (0, 0, 80891788386112939497749276978496951092908047537517752191112348346041605282820278415204830919700840360371114407873821260986140627885494462923855784343766007471406691139724032186081486065167152331309928933439563087594932165713814698240940689654799590764311096627705559355661741126880749623083953480524440103996, 98127807327139994371479310755482264253499077621954160265776803909962087269443207623777017430975688540885576031084499718360878131623357206459366594111595569751254398053416214104147757969318816248746123610412479211529236153906708864168414330919431944363564172025204269508207805032491500543298879609362168155698, 65511482182385099252523608525317643713139065614405324455763784441479732896196144143630212812577305057210145612770975280343168022555945650814573970996890826522557999047275529322348420693034478105886809355222570889445527587635177667364042090723912339748512431185136779345494523747668733698804934976215893958288, 47395420931311533463576620820998773093140094423967370338777509171164699213419123512474441784558146041667540557107610725716163070022770572094504815720978368593469076026134774205916872923158523446883115622548066715665889163816586554653727221255672945695748970848307935789400330008330191289067490505817853508862), (0, 0, 0, 80891788386112939497749276978496951092908047537517752191112348346041605282820278415204830919700840360371114407873821260986140627885494462923855784343766007471406691139724032186081486065167152331309928933439563087594932165713814698240940689654799590764311096627705559355661741126880749623083953480524440103996, 19698820472058378412126192842030797220400882933373012220982539297272840493833295012123104281630408975161684583174403520414441877705582176563034772573895923595952612217426667572338807473485060098014543992573292667351072747962727283791740574278403611513201362656878372277715791010274896917611983518661952140153, 123510953871821884312855093053364645536177520009689630246292371010124299893864894909800725518340823661094473516585146142340021906280407678497822070318952778328284650261834023459467329786786889648844029738405121401290299843929018994002831246816483309594538299064894303565350991068375984784398159294612728278815), (0, 0, 0, 0, 36580210170460317737762146444885635769591964296289890711389087000847139534806165797517572963756420701630101713343229692997790887039708011239887899158602488099058023454307392387825436996066794401349180417178870019892425641929320878895403740655587101563655595067050855919740156100994268635382369423383067032821, 39071393947194921035771816301731926515001496696996162605545586710593160202215733075781810261530483080161843001707288615255381706789857593381598670763208249387924275996361728526530257131514765795139507343167639937751870811497537961210868263876827751668386006289349446841212411861730197725192485058916383785937), (0, 0, 0, 0, 0, 36580210170460317737762146444885635769591964296289890711389087000847139534806165797517572963756420701630101713343229692997790887039708011239887899158602488099058023454307392387825436996066794401349180417178870019892425641929320878895403740655587101563655595067050855919740156100994268635382369423383067032821)]

C00 = C[0][0]
C01 = C[0][1]
C55 = C[5][5]
C33 = C[3][3]

n = GCD(C00 ^ 3 - C55, C00^2 - C33)
n = n // 5
G = Zmod(n)
C00 = G(C00)
C01 = G(C01)

Flag = C01 * C00^(-1) * 2
print(long_to_bytes(int(Flag)))
```

### RSAn’t

#### Attachments

```python
from random import *
from sage.all import *
from Crypto.Util.number import *
from secret import flag

def encrypt():
    tmp = randint(2**1023, 2**1024)
    p = next_prime(1337*tmp + randint(2, 2**512))
    q = next_prime(7331*tmp + randint(2, 2**512))
    N = p*q
    return N

def l3ak(n):
    print('Security Alert!!')
    print('There is a L3AKER l3aking our data!! [~] :/\n')
    c1 = pow(bytes_to_long(b"factoring modulus?"), e, n)
    c2 = pow(bytes_to_long(b"without the modulus?"), e, n)
    return c1, c2

e = 65537
n = encrypt()
enc = pow(flag, e, n)
c1, c2 = l3ak(n)

print(f'Encrypted flag = {enc}\n')
print(f'c1 = {c1}\n')
print(f'c2 = {c2}\n')
```

```text
# output
e = 65537

ciphertext = 179299686848994539141122382962230037744384497621603198124077003991636319769603564062817092353600906591207476251327282277695110268704615120068654776183507204512702766847930125900500659983050185274344899025779726523565280032908194763356944549824963215339419038543390439655210741510143003582737996617770895692162306286064421718892797213765237300926925675153074894532935937291295802157305724856321584517131226940140190491157709894421683196766707672593154406263054436900566231464719102312973247466510418770039194000878897515838985623461176782628261365771619698859295767451162504151010728056594695117040661023327968023451519804564

c1 = 123377882241082251325350065419048806024607608617091688983830323277604694641240653374439302807138122463323990418348747537591347656262195555533468416119550902963546537686539626424151682647446653286178409257716563958279306978514921053134482777035689209563599648603507287706662378931300585730154813000147325737518201568052630101704051194396183990174893718130243703251255733422231215114594356086085529845721945162634747194330158630722370297888040809287372214916411109961066039419282486341414973486625115394106601990911459069075609672097833893961312251252396858703096951885954537748265354572684903035976149443662164781331591137509

c2 = 216996462348882812127549126696128848915007479735759067925583940914005783704777739383583486500248026532990006813147882357469539758674416271697210195684094572116588619081813131930186778045755089586040232978039441432232050042271853194470413044599117641325812011411950889172242559099135026172425733801215110286748370156962444409678069139574351948837982999861835569715249682828276876910129256029485173183675521926552841364713489224945222100475996799601024631599522598983661501357640196487134275394097207489818217501235732511301942649024362999538093008833593968191799917057618382726046836320499881842515455356124359654138411130319
```

#### Implements

Mình sẽ recover n như sau

```python
from sage.all import *
from Crypto.Util.number import *

e = 65537
c1 = 123377882241082251325350065419048806024607608617091688983830323277604694641240653374439302807138122463323990418348747537591347656262195555533468416119550902963546537686539626424151682647446653286178409257716563958279306978514921053134482777035689209563599648603507287706662378931300585730154813000147325737518201568052630101704051194396183990174893718130243703251255733422231215114594356086085529845721945162634747194330158630722370297888040809287372214916411109961066039419282486341414973486625115394106601990911459069075609672097833893961312251252396858703096951885954537748265354572684903035976149443662164781331591137509
c2 = 216996462348882812127549126696128848915007479735759067925583940914005783704777739383583486500248026532990006813147882357469539758674416271697210195684094572116588619081813131930186778045755089586040232978039441432232050042271853194470413044599117641325812011411950889172242559099135026172425733801215110286748370156962444409678069139574351948837982999861835569715249682828276876910129256029485173183675521926552841364713489224945222100475996799601024631599522598983661501357640196487134275394097207489818217501235732511301942649024362999538093008833593968191799917057618382726046836320499881842515455356124359654138411130319

m1 = bytes_to_long(b'factoring modulus?')
m2 = bytes_to_long(b'without the modulus?')

N = gcd(pow(m1, e) - int(c1), pow(m2, e) - int(c2))
print(f'{N = }')

# N = 573705313470237088128697724011345537729683894813773026784491075891375787623474876644061916906451471924722277144379030941570465205946833957200688304499122972757670018621482568140886956686009200092360197152239823056384412058625497863977546406937961142478700220534582896797390680947594209881481624425897931034297127910081669705880067174821720273642918776110649889916889528110735095592416817545242751005238512957101272680451113761426278203742295886722523975429342004312924930404678014280113729314434769051596435530057776346632601974236264442330943600999709043920136852080203441976582246277392355669576484507651557516413526616046
```

```python
def encrypt():
    tmp = randint(2**1023, 2**1024)
    p = next_prime(1337*tmp + randint(2, 2**512))
    q = next_prime(7331*tmp + randint(2, 2**512))
    N = p*q
    return N
```

Chúng ta có thể thấy rằng các bit cao của cả hai số nguyên tố (p và q) đều giống nhau, sự khác biệt có thể nằm ở các bit thấp 512. Điều này có nghĩa là nếu chúng ta tính căn bậc hai của N (isqrt(N)), thì các bit cao sẽ tương ứng với các bit cao của p và q

```python
tmp = isqrt((N)/(1337*7331))
q_approx = 7331*tmp - 2**512
```


Bây giờ chúng ta có thể tạo ra một đa thức 

$$\boxed{F(x) = x + q_{approx} \mod N}$$

Sử dụng phương pháp Coppersmith, chúng ta có thể tìm các nghiệm

Recover Flag.

Python Implementation

```python
from sage.all import *
from Crypto.Util.number import *
from factordb.factordb import FactorDB

e = 65537

ciphertext = 179299686848994539141122382962230037744384497621603198124077003991636319769603564062817092353600906591207476251327282277695110268704615120068654776183507204512702766847930125900500659983050185274344899025779726523565280032908194763356944549824963215339419038543390439655210741510143003582737996617770895692162306286064421718892797213765237300926925675153074894532935937291295802157305724856321584517131226940140190491157709894421683196766707672593154406263054436900566231464719102312973247466510418770039194000878897515838985623461176782628261365771619698859295767451162504151010728056594695117040661023327968023451519804564

c1 = 123377882241082251325350065419048806024607608617091688983830323277604694641240653374439302807138122463323990418348747537591347656262195555533468416119550902963546537686539626424151682647446653286178409257716563958279306978514921053134482777035689209563599648603507287706662378931300585730154813000147325737518201568052630101704051194396183990174893718130243703251255733422231215114594356086085529845721945162634747194330158630722370297888040809287372214916411109961066039419282486341414973486625115394106601990911459069075609672097833893961312251252396858703096951885954537748265354572684903035976149443662164781331591137509

c2 = 216996462348882812127549126696128848915007479735759067925583940914005783704777739383583486500248026532990006813147882357469539758674416271697210195684094572116588619081813131930186778045755089586040232978039441432232050042271853194470413044599117641325812011411950889172242559099135026172425733801215110286748370156962444409678069139574351948837982999861835569715249682828276876910129256029485173183675521926552841364713489224945222100475996799601024631599522598983661501357640196487134275394097207489818217501235732511301942649024362999538093008833593968191799917057618382726046836320499881842515455356124359654138411130319

m1 = bytes_to_long(b'factoring modulus?')
m2 = bytes_to_long(b'without the modulus?')

N = gcd(pow(m1, e) - int(c1), pow(m2, e) - int(c2))
print(f'{N = }')

f = FactorDB(N); f.connect(); [p, q] = f.get_factor_list()
print(f"{p = } \n {q = }")
N = N // 2


tmp = isqrt(N/(1337*7331))
print(f'{tmp = }')

q_approx = 7331*tmp - 2**512
F.<x> = PolynomialRing(Zmod(N), implementation='NTL')
f = x + q_approx
roots = f.small_roots(X=2**512, beta=0.1)

for delta in roots:
    q = q_approx + delta
    p = int(N) // int(q)
    phi = (p-1)*(q-1)
    d = pow(e, -1, phi)
    flag = long_to_bytes(int(pow(ciphertext, d, N))).decode()
    print(f'flag = {flag}')
```

### Related

#### Attachments

```python
import random
from flag import FLAG
from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes

p = getPrime(1024)
q = getPrime(1024)
n = p * q
e = 0x101

def pad(flag):
    m = bytes_to_long(flag)
    a = random.randint(2, n)
    b = random.randint(2, n)
    return (a, b), a*m+b

def encrypt(flag):
    padded_variables, padded_message = pad(flag)
    encrypted = pow(padded_message, e, n)
    return padded_variables, encrypted

variables, ct1 = encrypt(FLAG)
a1 = variables[0]
b1 = variables[1]

variables, ct2 = encrypt(FLAG)
a2 = variables[0]
b2 = variables[1]

print(f"{n = }")
print(f"{a1 = }")
print(f"{b1 = }")
print(f"{ct1 = }")
print(f"{a2 = }")
print(f"{b2 = }")
print(f"{ct2 = }")
```

```text
# output

n = 23446116820809956009508921267229329419806339208735431213584717790131416299556366048048977867380629435292555358502917305856047632651197352306945681062223443217527823509039445684919455982744684852068434951030105274549124012946448685060750456093120953320196777137936137902703756422225716380021864017594031233341531336018572970546112899850343992552126107820367629786159724290948728494321350895295087900001068499072242213916345639268473176748281877628559969801359815109260695490545357491404689132480248206287353580339535458835525161032145136894301169515951010316007454927062229765757932923091679510627796469997185047770119
a1 = 8104040836262507446864591234691358718164908580334110843106050982408624642389131164005601569999434432648709609777743793997208912520844943698036947408725027128235833538793471035056805185723079446135588491317378316082567779128276652380455054959975686544145446500257748715018799178783100289455255670805079936852471138049711583797615770901244436979110584710970079641409159097959783566594440737682826559724447739807028855072087914855150495360099989261682566388742966224528680792157619533719489447251411976029565538810357759752921276377948448704648350306514866111068184157760563297810978279434204440014428745729905509605285
b1 = 1728445028759460100268916851157941317747744991464848324630394207912877842639961858831903114707815701742483947978256582554473425946268457939887471248397622887505458768276338958573804608581353987536415380192782284575648580559755923454408763552113403890642303139141765381991794536720006159278517578791058556250982111713910060167032647218698362613084823406687399478088149985930840603408274198692032083156828441656375986195794109996772306557258447129571560905620272546405603257541870547380051900022925294193741417962861863860715434297040138205460211370506997331099668562619882982110566078451957682401843673938997454325985
ct1 = 7133574145118001624468851232768367610776481589816189114081484875167835285211475440236501712634938993477027789627285581268361018888589847771555770716521123959004389671272089766710340921550798461319697963644164596608774387203602804547184454077314801365322929817266934087883757605888082111393091270686060676504784482770435773757625762542094784777964406426404482882414828990658303263295993951921074284755818657012216398826105099627761519486438690405668440835527144374828045319113524249938249744799530870449189528166252037249009094063960558703857141043081099174412277124506544776530125652348821688752923438304710034397792
a2 = 6932198124642373427967232343817468902255209063707505631753623131468591968939116907766874533903771236309508029958603993113318003707536772796355326212684792901937391081839814883783063784050698582961314998290360613480778658142959804536224436521802834308095784814005774038096434723020316915995654759582638114351622288228138452404715021874261743824588698845194567350953613460211780903933501965152586633117799392776012574047439430079820078546000748259648002297803211427390366076552057374120223207399161502626197672749700677144769182115211864885324511059266535644202147069163420794861424973102200053615106664642762054707456
b2 = 17570492860498497589391311850810042101436988882059207563836745301643757694348737390349588510867234608796253222240056487274815481193573640552151307710984790365040907600873879523821340341063776797845384078798440533883164972773525749702026085462782235008812515983104980108840777316735468521572249232663287631112374534186975231033281807029801530398687397396929300293283833448151885674196708775598652356402354479252567714152805778278207736053329489014866155493921442482258381840272615320018058870234668488517354399053820878325928972260161611818894133121294554947400621261460441395783860055835185154356326202402937413717222
ct2 = 8778761624514690203726370366823530128900480928985439769115219364620387269991756967930541323829570453896164780238656562595733025340650482503284244625778872560261904887674968133049252085507078563540106328260114811619983171932648876602484063356832075687231100750407167402096299904835776594509894740386041222719008023556447633524625419665210188090816622517361786836014525679069179481575048514551967532281399777505866483289055530051032001545010914680661193107730444980281645735808124289602346876529763644878375393094200846185413267940739865639764057094273259729425291615810027734657664217752026488492540376475948687563210
```

#### Implement

Với bài này khá giống bài